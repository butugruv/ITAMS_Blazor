@page "/Devices"
@using System.Collections.ObjectModel;
@inject IDeviceData deviceData
@inject NavigationManager navigationManager

<PageTitle>Devices</PageTitle>

<div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
    <h2>Devices</h2>
    <div class="btn-group me-2">
        <AuthorizeView Roles="ITAMSAdmin,ITAMSEdit">
            <Authorized>
                <button type="button" class="btn btn-primary" @onclick="HandleCreateButtonClick">Create Device</button>
            </Authorized>
        </AuthorizeView>

    </div>
</div>

@if (deviceList == null)
{
    <h4>Loading...</h4>
}
else
{
    <TelerikGrid Data="@deviceList" Pageable="true" Sortable="true" FilterMode="@GridFilterMode.FilterMenu"
             Resizable="true" ShowColumnMenu="true" Reorderable="true" Groupable="true" PageSize="10">

        <GridToolBar>
            <GridSearchBox Width="300px;"/>
            <GridCommandButton Command="ExcelExport" Icon="file-excel">Export to Excel</GridCommandButton>
        </GridToolBar>
        <GridColumns>
            <GridCommandColumn Width="70px" Context="dataItem">
                <AuthorizeView Roles="ITAMSAdmin,ITAMSEdit">
                    <Authorized>
                        <GridCommandButton ThemeColor="primary" Command="EditDevice" OnClick="@( () => HandleEditButtonClick(dataItem as IDevicesWithLookupsModel) )">Edit</GridCommandButton>
                    </Authorized>
                </AuthorizeView>
            </GridCommandColumn>

            
            <GridColumn Field="DeviceName" Title="Device Name" Width="250px" />
            <GridColumn Field="DeviceFunction" Width="250px" Title="Device Function" />
            <GridColumn Field="TypeName" Width="250px" Title="Device Type" />
            <GridColumn Field="Manufacturer" Width="250px" />
            <GridColumn Field="Model" Width="250px" />
            <GridColumn Field="Poc" Width="250px" />
            <GridColumn Field="LocationName" Width="250px" />
            <GridColumn Field="Floor" Width="250px" />
            <GridColumn Field="Room" Width="250px" />
            <GridColumn Field="PackageName" Width="250px" Title="RMF Package"/>
            <GridColumn Field="CreatedDate" Width="250px" />
            <GridColumn Field="CreatedBy" Width="250px" />
            <GridColumn Field="ModifiedDate" Width="250px" />
            <GridColumn Field="ModifiedBy" Width="250px" />

        </GridColumns>
    </TelerikGrid>
}

<DeviceFormModal Id="deviceId" WindowVisible="@windowVisible" OnSubmitted="HandleOnSubmitted"></DeviceFormModal>

<TelerikNotification @ref="@Notification" Class="demo-notification" VerticalPosition="NotificationVerticalPosition.Bottom" HorizontalPosition="NotificationHorizontalPosition.Right">
</TelerikNotification>

@code {
    //separated out the code into Devices.cs
}